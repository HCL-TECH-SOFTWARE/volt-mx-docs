Ext.data.JsonP.com_android_server_am_PersistentConnection({"tagname":"class","name":"com.android.server.am.PersistentConnection","autodetected":{},"files":[{"filename":"PersistentConnection.js","href":"PersistentConnection.html#com-android-server-am-PersistentConnection"}],"extends":"java.lang.Object","members":[{"name":"bind","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-bind","meta":{}},{"name":"bindInnerLocked","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-bindInnerLocked","meta":{}},{"name":"dump","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-dump","meta":{}},{"name":"getComponentName","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-getComponentName","meta":{}},{"name":"getNextBackoffMs","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-getNextBackoffMs","meta":{}},{"name":"getNumBindingDied","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-getNumBindingDied","meta":{}},{"name":"getNumConnected","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-getNumConnected","meta":{}},{"name":"getNumDisconnected","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-getNumDisconnected","meta":{}},{"name":"getServiceBinder","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-getServiceBinder","meta":{}},{"name":"getUserId","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-getUserId","meta":{}},{"name":"isBound","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-isBound","meta":{}},{"name":"isConnected","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-isConnected","meta":{}},{"name":"isRebindScheduled","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-isRebindScheduled","meta":{}},{"name":"unbind","tagname":"method","owner":"com.android.server.am.PersistentConnection","id":"method-unbind","meta":{}}],"alternateClassNames":[],"aliases":{},"id":"class-com.android.server.am.PersistentConnection","short_doc":"Connects to a given service component on a given user. ...","classIcon":"icon-class","superclasses":["java.lang.Object"],"subclasses":[],"mixedInto":[],"mixins":[],"parentMixins":[],"requires":[],"uses":[],"html":"<div><pre class=\"hierarchy\"><h4>Hierarchy</h4><div class='subclass first-child'>java.lang.Object<div class='subclass '><strong>com.android.server.am.PersistentConnection</strong></div></div><h4>Files</h4><div class='dependency'><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection' target='_blank'>PersistentConnection.js</a></div></pre><div class='doc-contents'><p>Connects to a given service component on a given user.</p>\n\n<ul>\n<li>Call <a href=\"#!/api/com.android.server.am.PersistentConnection-method-bind\" rel=\"com.android.server.am.PersistentConnection-method-bind\" class=\"docClass\">bind</a>() to create a connection.</li>\n<li>Call <a href=\"#!/api/com.android.server.am.PersistentConnection-method-unbind\" rel=\"com.android.server.am.PersistentConnection-method-unbind\" class=\"docClass\">unbind</a>() to disconnect.  Make sure to disconnect when the user stops.</li>\n</ul>\n\n\n<p> Add onConnected/onDisconnected callbacks as needed.</p>\n\n<p> When the target process gets killed (by OOM-killer, etc), then the activity manager will\n re-connect the connection automatically, in which case onServiceDisconnected() gets called\n and then onServiceConnected().</p>\n\n<p> However sometimes the activity manager just \"kills\" the connection -- like when the target\n package gets updated or the target process crashes multiple times in a row, in which case\n onBindingDied() gets called.  This class handles this case by re-connecting in the time\n mRebindBackoffMs.  If this happens again, this class increases the back-off time\n by mRebindBackoffIncrease and retry.  The back-off time is capped at\n mRebindMaxBackoffMs.</p>\n\n<p> The back-off time will never be reset until <a href=\"#!/api/com.android.server.am.PersistentConnection-method-unbind\" rel=\"com.android.server.am.PersistentConnection-method-unbind\" class=\"docClass\">unbind</a>() and <a href=\"#!/api/com.android.server.am.PersistentConnection-method-bind\" rel=\"com.android.server.am.PersistentConnection-method-bind\" class=\"docClass\">bind</a>() are called\n explicitly.</p>\n\n<p> NOTE: This class does <em>not</em> handle package-updates -- i.e. even if the binding dies due to\n the target package being updated, this class won't reconnect.  This is because this class doesn't\n know what to do when the service component has gone missing, for example.  If the user of this\n class wants to restore the connection, then it should call <a href=\"#!/api/com.android.server.am.PersistentConnection-method-unbind\" rel=\"com.android.server.am.PersistentConnection-method-unbind\" class=\"docClass\">unbind</a>() and <a href=\"#!/api/com.android.server.am.PersistentConnection-method-bind\" rel=\"com.android.server.am.PersistentConnection-method-bind\" class=\"docClass\">bind</a>\n explicitly.</p>\n\n<p> atest ${ANDROID_BUILD_TOP}/frameworks/base/services/tests/mockingservicestests/src/com/android/server/am/PersistentConnectionTest.java</p>\n</div><div class='members'><div class='members-section'><div class='definedBy'>Defined By</div><h3 class='members-title icon-method'>Methods</h3><div class='subsection'><div id='method-bind' class='member first-child not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-bind' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-bind' class='name expandable'>bind</a>( <span class='pre'></span> )<span class=\"signature\"></span></div><div class='description'><div class='short'>Connects to the service. ...</div><div class='long'><p>Connects to the service.</p>\n</div></div></div><div id='method-bindInnerLocked' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-bindInnerLocked' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-bindInnerLocked' class='name expandable'>bindInnerLocked</a>( <span class='pre'></span> )<span class=\"signature\"></span></div><div class='description'><div class='short'> ...</div><div class='long'>\n</div></div></div><div id='method-dump' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-dump' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-dump' class='name expandable'>dump</a>( <span class='pre'></span> )<span class=\"signature\"></span></div><div class='description'><div class='short'> ...</div><div class='long'>\n</div></div></div><div id='method-getComponentName' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-getComponentName' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-getComponentName' class='name expandable'>getComponentName</a>( <span class='pre'></span> )<span class=\"signature\"></span></div><div class='description'><div class='short'> ...</div><div class='long'>\n</div></div></div><div id='method-getNextBackoffMs' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-getNextBackoffMs' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-getNextBackoffMs' class='name expandable'>getNextBackoffMs</a>( <span class='pre'></span> )<span class=\"signature\"></span></div><div class='description'><div class='short'>Return the next back-off time ...</div><div class='long'><p>Return the next back-off time</p>\n</div></div></div><div id='method-getNumBindingDied' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-getNumBindingDied' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-getNumBindingDied' class='name expandable'>getNumBindingDied</a>( <span class='pre'></span> )<span class=\"signature\"></span></div><div class='description'><div class='short'>Return the number of times the binding died callback called. ...</div><div class='long'><p>Return the number of times the binding died callback called.</p>\n</div></div></div><div id='method-getNumConnected' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-getNumConnected' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-getNumConnected' class='name expandable'>getNumConnected</a>( <span class='pre'></span> )<span class=\"signature\"></span></div><div class='description'><div class='short'>Return the number of times the connected callback called. ...</div><div class='long'><p>Return the number of times the connected callback called.</p>\n</div></div></div><div id='method-getNumDisconnected' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-getNumDisconnected' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-getNumDisconnected' class='name expandable'>getNumDisconnected</a>( <span class='pre'></span> )<span class=\"signature\"></span></div><div class='description'><div class='short'>Return the number of times the disconnected callback called. ...</div><div class='long'><p>Return the number of times the disconnected callback called.</p>\n</div></div></div><div id='method-getServiceBinder' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-getServiceBinder' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-getServiceBinder' class='name expandable'>getServiceBinder</a>( <span class='pre'></span> ) : Object {java.lang.Object}<span class=\"signature\"></span></div><div class='description'><div class='short'> ...</div><div class='long'>\n<h3 class='pa'>Returns</h3><ul><li><span class='pre'>Object {java.lang.Object}</span><div class='sub-desc'><p>the service binder interface.</p>\n</div></li></ul></div></div></div><div id='method-getUserId' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-getUserId' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-getUserId' class='name expandable'>getUserId</a>( <span class='pre'></span> )<span class=\"signature\"></span></div><div class='description'><div class='short'> ...</div><div class='long'>\n</div></div></div><div id='method-isBound' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-isBound' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-isBound' class='name expandable'>isBound</a>( <span class='pre'></span> ) : Boolean<span class=\"signature\"></span></div><div class='description'><div class='short'> ...</div><div class='long'>\n<h3 class='pa'>Returns</h3><ul><li><span class='pre'>Boolean</span><div class='sub-desc'><p>whether bind() has been called and unbind() hasn't.</p>\n\n<p> Note when the AM gives up on connection, this class detects it and un-bind automatically,\n and schedule rebind, and <a href=\"#!/api/com.android.server.am.PersistentConnection-method-isBound\" rel=\"com.android.server.am.PersistentConnection-method-isBound\" class=\"docClass\">isBound</a> returns false when it's waiting for a retry.</p>\n</div></li></ul></div></div></div><div id='method-isConnected' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-isConnected' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-isConnected' class='name expandable'>isConnected</a>( <span class='pre'></span> ) : Boolean<span class=\"signature\"></span></div><div class='description'><div class='short'> ...</div><div class='long'>\n<h3 class='pa'>Returns</h3><ul><li><span class='pre'>Boolean</span><div class='sub-desc'><p>whether connected.</p>\n</div></li></ul></div></div></div><div id='method-isRebindScheduled' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-isRebindScheduled' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-isRebindScheduled' class='name expandable'>isRebindScheduled</a>( <span class='pre'></span> ) : Boolean<span class=\"signature\"></span></div><div class='description'><div class='short'> ...</div><div class='long'>\n<h3 class='pa'>Returns</h3><ul><li><span class='pre'>Boolean</span><div class='sub-desc'><p>whether re-bind is scheduled after the AM gives up on a connection.</p>\n</div></li></ul></div></div></div><div id='method-unbind' class='member  not-inherited'><a href='#' class='side expandable'><span>&nbsp;</span></a><div class='title'><div class='meta'><span class='defined-in' rel='com.android.server.am.PersistentConnection'>com.android.server.am.PersistentConnection</span><br/><a href='source/PersistentConnection.html#com-android-server-am-PersistentConnection-method-unbind' target='_blank' class='view-source'>view source</a></div><a href='#!/api/com.android.server.am.PersistentConnection-method-unbind' class='name expandable'>unbind</a>( <span class='pre'></span> )<span class=\"signature\"></span></div><div class='description'><div class='short'>Disconnect from the service. ...</div><div class='long'><p>Disconnect from the service.</p>\n</div></div></div></div></div></div></div>","meta":{}});